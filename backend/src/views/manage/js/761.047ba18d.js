"use strict";(self["webpackChunkvue3_nb0"]=self["webpackChunkvue3_nb0"]||[]).push([[761],{83761:(e,t,l)=>{l.r(t),l.d(t,{default:()=>y});l(46173),l(91917),l(33147),l(23453),l(22545),l(95653),l(59380),l(11641),l(83466),l(56889),l(29407),l(89123),l(22595),l(65182),l(59695),l(38388),l(64966),l(36254);var n=l(53262),a=l(56053),u=(l(35558),l(94707),l(46791)),i=l(81737),r=l(10985),o=l(72971),c=l(66802),s=l(87629),d=(l(67799),l(16554),{class:"formModel_btn_box"});const v={__name:"formModel",emits:["formModelChange"],setup:function(e,t){var l,a=t.expose,i=t.emit,r=(0,o.oR)(),v=(0,n.Fl)((function(){return r.getters["user/session"]})),f=null===(l=(0,n.FN)())||void 0===l?void 0:l.appContext.config.globalProperties,p="chathelper",h="聊天助手",m=(0,u.iH)({}),g=(0,u.iH)({ask:!1,reply:!1}),w=(0,u.iH)(!1),k=(0,u.iH)(!1),_=(0,u.iH)(""),y=(0,u.iH)({ask:[],reply:[]}),b=(0,u.iH)(null),H=(0,u.iH)(0),C=(0,u.iH)(""),x=function(){m.value={ask:"",reply:""}},W=function(){null===f||void 0===f||f.$http({url:"".concat(p,"/info/").concat(H.value),method:"get"}).then((function(e){new RegExp("../../../file","g");m.value=e.data.data,w.value=!0}))},U=(0,u.iH)(""),Z=(0,u.iH)(""),$=(0,u.iH)(""),z=(0,u.iH)(""),j=(0,u.iH)(""),V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,r=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(x(),e&&(H.value=e,C.value=t),"add"==t)k.value=!0,_.value="新增"+h,w.value=!0;else if("info"==t)k.value=!1,_.value="查看"+h,W();else if("edit"==t)k.value=!0,_.value="修改"+h,W();else if("cross"==t){for(var o in k.value=!0,_.value=l,n)"ask"!=o?"reply"!=o||(m.value.reply=n[o],g.value.reply=!0):(m.value.ask=n[o],g.value.ask=!0);n&&(U.value=n),a&&(Z.value=a),i&&($.value=i),u&&(z.value=u),r&&(j.value=r),w.value=!0}};a({init:V});var N=function(){w.value=!1},S=function(){var e=(0,s.Z)((0,c.Z)().mark((function e(){var t,l,n,a,u;return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Z.value,t=JSON.parse(JSON.stringify(U.value)),l="",n="",a="","cross"==C.value&&""!=z.value)if(z.value.startsWith("["))l=v.value.id,n=t["id"],a=z.value.replace(/\[/,"").replace(/\]/,"");else{for(u in t)u==z.value&&(t[u]=j.value);M(t)}b.value.validate((function(e){if(e)if(l&&n){m.value.crossuserid=l,m.value.crossrefid=n;var t={page:1,limit:1e3,crossuserid:m.value.crossuserid,crossrefid:m.value.crossrefid};null===f||void 0===f||f.$http({url:"".concat(p,"/page"),method:"get",params:t}).then((function(e){if(e.data.data.total>=a)return null===f||void 0===f||f.$toolUtil.message("".concat($.value),"error"),!1;null===f||void 0===f||f.$http({url:"".concat(p,"/").concat(m.value.id?"update":"save"),method:"post",data:m.value}).then(function(){var e=(0,s.Z)((0,c.Z)().mark((function e(t){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:i("formModelChange"),null===f||void 0===f||f.$toolUtil.message("操作成功","success"),w.value=!1;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}))}else null===f||void 0===f||f.$http({url:"".concat(p,"/").concat(m.value.id?"update":"save"),method:"post",data:m.value}).then(function(){var e=(0,s.Z)((0,c.Z)().mark((function e(t){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:i("formModelChange"),null===f||void 0===f||f.$toolUtil.message("操作成功","success"),w.value=!1;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());else f.$message.error("请完善信息")}));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=(0,s.Z)((0,c.Z)().mark((function e(t){return(0,c.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if("cross"!=C.value){e.next=3;break}return e.next=3,null===f||void 0===f?void 0:f.$http({url:"".concat(Z.value,"/update"),method:"post",data:t}).then((function(e){}));case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return function(e,t){var l=(0,n.up)("el-input"),a=(0,n.up)("el-form-item"),u=(0,n.up)("el-col"),i=(0,n.up)("el-row"),r=(0,n.up)("el-form"),o=(0,n.up)("el-button"),c=(0,n.up)("el-dialog");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n.Wm)(c,{"modal-class":"edit_form_modal",class:"edit_form",modelValue:w.value,"onUpdate:modelValue":t[2]||(t[2]=function(e){return w.value=e}),title:_.value,width:"60%","destroy-on-close":"",fullscreen:!1},(0,n.Nv)({default:(0,n.w5)((function(){return[(0,n.Wm)(r,{class:"formModel_form",ref_key:"formRef",ref:b,model:m.value,rules:y.value},{default:(0,n.w5)((function(){return[(0,n.Wm)(i,null,{default:(0,n.w5)((function(){return[(0,n.Wm)(u,{span:24},{default:(0,n.w5)((function(){return[(0,n.Wm)(a,{label:"提问内容",prop:"ask"},{default:(0,n.w5)((function(){return[(0,n.Wm)(l,{class:"list_inp",modelValue:m.value.ask,"onUpdate:modelValue":t[0]||(t[0]=function(e){return m.value.ask=e}),placeholder:"提问内容",type:"text",readonly:!(k.value&&!g.value.ask)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1}),(0,n.Wm)(u,{span:24},{default:(0,n.w5)((function(){return[(0,n.Wm)(a,{label:"回复内容",prop:"reply"},{default:(0,n.w5)((function(){return[(0,n.Wm)(l,{modelValue:m.value.reply,"onUpdate:modelValue":t[1]||(t[1]=function(e){return m.value.reply=e}),placeholder:"回复内容",type:"textarea",readonly:!(k.value&&!g.value.reply)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["model","rules"])]})),_:2},[k.value||"logistics"==C.value||"reply"==C.value?{name:"footer",fn:(0,n.w5)((function(){return[(0,n._)("span",d,[(0,n.Wm)(o,{class:"cancel_btn",onClick:N},{default:(0,n.w5)((function(){return[(0,n.Uk)("取消")]})),_:1}),(0,n.Wm)(o,{class:"confirm_btn",type:"primary",onClick:S},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 提交 ")]})),_:1})])]})),key:"0"}:void 0]),1032,["modelValue","title"])])}}};var f=l(91859);const p=(0,f.Z)(v,[["__scopeId","data-v-4603dd44"]]),h=p;var m={class:"center_view"},g={class:"list_search_view"},w={class:"btn_view"};const k={__name:"list",setup:function(e){var t,l=(0,o.oR)(),c=((0,n.Fl)((function(){return l.getters["user/session"]})),(0,u.iH)(l.state.user.avatar),null===(t=(0,n.FN)())||void 0===t?void 0:t.appContext.config.globalProperties),s="chathelper",d="聊天助手";(0,i.yj)(),(0,i.tv)();(0,n.bv)((function(){}));var v=(0,u.iH)(null),f=(0,u.iH)(null),p=(0,u.iH)({page:1,limit:20,sort:"id",order:"desc"}),k=(0,u.iH)({}),_=(0,u.iH)([]),y=(0,u.iH)(!1),b=function(e){(0,n.Y3)((function(){f.value.toggleRowSelection(e)}))},H=function(){y.value=!0;var e=JSON.parse(JSON.stringify(p.value));e["sort"]="id",e["order"]="desc",c.$http({url:"".concat(s,"/page"),method:"get",params:e}).then((function(e){y.value=!1,v.value=e.data.data.list,W.value=Number(e.data.data.total)}))},C=function(e){var t=[];if(e)t=[e];else{if(!_.value.length)return!1;for(var l in _.value)t.push(_.value[l].id)}r.T.confirm("是否删除选中".concat(d),"提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then((function(){c.$http({url:"".concat(s,"/delete"),method:"post",data:t}).then((function(e){null===c||void 0===c||c.$toolUtil.message("删除成功","success",(function(){H()}))}))}))["catch"]((function(e){}))},x=function(e){_.value=e},W=(0,u.iH)(0),U=(0,u.iH)(["total","prev","pager","next","sizes","jumper"]),Z=function(e){p.value.limit=e,H()},$=function(e){p.value.page=e,H()},z=function(e,t){return null===c||void 0===c?void 0:c.$toolUtil.isAuth(e,t)},j=function(){p.value.page=1,H()},V=(0,u.iH)(null),N=function(){j()},S=function(){V.value.init()},M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?V.value.init(e,"edit"):_.value.length&&V.value.init(_.value[0].id,"edit")},R=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?V.value.init(e,"info"):_.value.length&&V.value.init(_.value[0].id,"info")},q=function(){H()};return q(),function(e,t){var l=(0,n.up)("el-form"),u=(0,n.up)("el-button"),i=(0,n.up)("el-table-column"),r=(0,n.up)("el-table"),o=(0,n.up)("el-pagination"),c=(0,n.Q2)("loading");return(0,n.wg)(),(0,n.iD)("div",null,[(0,n._)("div",m,[(0,n._)("div",g,[(0,n.Wm)(l,{model:k.value,class:"search_form"},null,8,["model"]),(0,n._)("div",w,[z("chathelper","新增")?((0,n.wg)(),(0,n.j4)(u,{key:0,class:"add_btn",type:"success",onClick:S},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 新增 ")]})),_:1})):(0,n.kq)("",!0),z("chathelper","删除")?((0,n.wg)(),(0,n.j4)(u,{key:1,class:"del_btn",type:"danger",disabled:!_.value.length,onClick:t[0]||(t[0]=function(e){return C(null)})},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 删除 ")]})),_:1},8,["disabled"])):(0,n.kq)("",!0)])]),z("chathelper","查看")?(0,n.wy)(((0,n.wg)(),(0,n.j4)(r,{key:0,border:"",stripe:!1,onSelectionChange:x,ref_key:"table",ref:f,data:v.value,onRowClick:b},{default:(0,n.w5)((function(){return[(0,n.Wm)(i,{resizable:!0,align:"left","header-align":"left",type:"selection",width:"55"}),(0,n.Wm)(i,{label:"序号",width:"70",resizable:!0,align:"left","header-align":"left"},{default:(0,n.w5)((function(e){return[(0,n.Uk)((0,a.zw)((p.value.page-1)*p.value.limit+e.$index+1),1)]})),_:1}),(0,n.Wm)(i,{"min-width":"140",resizable:!0,sortable:!0,align:"left","header-align":"left",prop:"ask",label:"提问内容"},{default:(0,n.w5)((function(e){return[(0,n.Uk)((0,a.zw)(e.row.ask),1)]})),_:1}),(0,n.Wm)(i,{label:"操作",width:"300",resizable:!0,sortable:!0,align:"left","header-align":"left"},{default:(0,n.w5)((function(e){return[z("chathelper","查看")?((0,n.wg)(),(0,n.j4)(u,{key:0,class:"view_btn",type:"info",onClick:function(t){return R(e.row.id)}},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 详情 ")]})),_:2},1032,["onClick"])):(0,n.kq)("",!0),z("chathelper","修改")?((0,n.wg)(),(0,n.j4)(u,{key:1,class:"edit_btn",type:"primary",onClick:function(t){return M(e.row.id)}},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 修改 ")]})),_:2},1032,["onClick"])):(0,n.kq)("",!0),z("chathelper","删除")?((0,n.wg)(),(0,n.j4)(u,{key:2,class:"del_btn",type:"danger",onClick:function(t){return C(e.row.id)}},{default:(0,n.w5)((function(){return[(0,n.Uk)(" 删除 ")]})),_:2},1032,["onClick"])):(0,n.kq)("",!0)]})),_:1})]})),_:1},8,["data"])),[[c,y.value]]):(0,n.kq)("",!0),(0,n.Wm)(o,{background:"",layout:U.value.join(","),total:W.value,"page-size":p.value.limit,"current-page":p.value.page,"onUpdate:currentPage":t[1]||(t[1]=function(e){return p.value.page=e}),"prev-text":"<","next-text":">","hide-on-single-page":!1,style:{width:"100%",padding:"0",margin:"20px 0 0",whiteSpace:"nowrap",color:"#333",fontWeight:"500"},"page-sizes":[10,20,30,40,50,100],onSizeChange:Z,onCurrentChange:$},null,8,["layout","total","page-size","current-page"])]),(0,n.Wm)(h,{ref_key:"formRef",ref:V,onFormModelChange:N},null,512)])}}},_=(0,f.Z)(k,[["__scopeId","data-v-179d7272"]]),y=_}}]);
//# sourceMappingURL=761.047ba18d.js.map